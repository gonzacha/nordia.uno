<!DOCTYPE html>
<html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Dashboard - GTA OCR System</title><style>*{ margin: 0; padding: 0; box-sizing: border-box; }body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; min-height: 100vh; padding: 20px; }.container { max-width: 1400px; margin: 0 auto; }.header { background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%); color: white; padding: 20px 30px; border-radius: 15px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }.main-content { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }.card { background: white; border-radius: 15px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }.log-section { grid-column: 1 / -1; background: #1a1a1a; border-radius: 15px; padding: 20px; color: #00ff00; font-family: 'Courier New', monospace; font-size: 0.9rem; max-height: 300px; overflow-y: auto; }.btn { background: linear-gradient(135deg, #3498db, #2980b9); color: white; border: none; padding: 12px 25px; border-radius: 10px; cursor: pointer; font-size: 1rem; font-weight: 600; transition: all 0.3s ease; text-decoration: none; display: block; text-align: center; }.btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4); }.btn-logout { background: linear-gradient(135deg, #e74c3c, #c0392b); }.ocr-result { background: #f8f9fa; border-radius: 10px; padding: 20px; margin-top: 20px; border-left: 4px solid #28a745; }.spinner { border: 4px solid rgba(0, 0, 0, 0.1); width: 36px; height: 36px; border-radius: 50%; border-left-color: #3498db; animation: spin 1s ease infinite; margin: 20px auto; }@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }</style></head><body><div class="container"><header class="header"><div><h1 style="font-size: 1.5rem; font-weight: bold;">🚀 GTA OCR Dashboard</h1><p style="opacity: 0.9;">Bienvenido, {{ current_user.username }}</p></div><a href="{{ url_for('main.logout') }}" class="btn btn-logout"><i data-lucide="log-out" style="width: 20px; height: 20px; display: inline-block; vertical-align: middle; margin-right: 8px;"></i>Cerrar Sesión</a></header><div class="main-content"><div class="card"><form id="upload-form"><input type="file" id="file-input" name="file" accept="image/*" style="display: none;"><div class="upload-zone" style="text-align: center; padding: 20px; border: 2px dashed #dee2e6; border-radius: 10px; cursor: pointer;" onclick="document.getElementById('file-input').click();"><div class="upload-icon" style="width: 60px; height: 60px; margin: 0 auto 15px; background: #3498db; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white;"><i data-lucide="upload" style="width: 30px; height: 30px;"></i></div><h3>Procesar Telegrama Real</h3><p style="font-size: 0.9rem; color: #6c757d; margin-top: 10px;">Haz clic aquí para seleccionar una imagen</p><p id="file-name" style="font-size: 0.8rem; color: #28a745; margin-top: 5px; font-weight: bold;"></p></div><button type="submit" class="btn" style="width: 100%; margin-top: 20px;">Procesar Imagen Seleccionada</button></form></div><div class="card"><h3>📊 Resultados del Procesamiento</h3><div id="resultsContainer"><p id="resultsPlaceholder" style="color: #6c757d; text-align: center; margin-top: 20px;">Los resultados del OCR aparecerán aquí...</p><div class="spinner" id="loadingSpinner" style="display: none;"></div><div id="ocrResults" style="display: none;"><div class="ocr-result"><h4>📝 Texto Extraído por la IA</h4><pre id="extractedText" style="white-space: pre-wrap; font-family: 'Courier New', monospace; margin-top: 10px;"></pre></div></div></div></div><div class="log-section"><h3 style="color: #00ff00; margin-bottom: 15px;">📋 Logs del Frontend</h3><div id="logContainer"></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.js"></script><script>lucide.createIcons();const uploadForm=document.getElementById("upload-form"),fileInput=document.getElementById("file-input"),logContainer=document.getElementById("logContainer"),fileNameDisplay=document.getElementById("file-name"),placeholder=document.getElementById("resultsPlaceholder"),spinner=document.getElementById("loadingSpinner"),resultsDiv=document.getElementById("ocrResults"),extractedText=document.getElementById("extractedText");let isProcessing=!1;function logToConsole(e,t="INFO"){const o=new Date().toISOString().slice(0,19).replace("T"," "),n=document.createElement("div");n.textContent=`{"time": "${o}", "level": "${t}", "name": "gta_frontend", "message": "${e}"}`,logContainer.appendChild(n),logContainer.scrollTop=logContainer.scrollHeight}fileInput.addEventListener("change",()=>{fileNameDisplay.textContent=fileInput.files.length>0?`Seleccionado: ${fileInput.files[0].name}`:""}),uploadForm.addEventListener("submit",async function(e){e.preventDefault(),isProcessing?logToConsole("Ya hay un proceso en curso.","WARN"):fileInput.files[0]?(isProcessing=!0,logToConsole(`Enviando archivo: ${fileInput.files[0].name}`),placeholder.style.display="none",resultsDiv.style.display="none",spinner.style.display="block",(()=>{const e=new FormData;e.append("file",fileInput.files[0]);try{fetch("{{ url_for('main.upload') }}",{method:"POST",body:e}).then(e=>e.json()).then(e=>{spinner.style.display="none",e.task_id?(logToConsole(`Procesamiento en cola. ID de tarea: ${e.task_id}`),logToConsole("Revisa la terminal del worker para ver el resultado del OCR.")):(logToConsole(`Error del servidor: ${e.error||"Error desconocido"}`,"ERROR"),placeholder.textContent=`Error: ${e.error||"No se pudo procesar."}`,placeholder.style.display="block")})}catch(e){console.error("Error en el fetch:",e),spinner.style.display="none",logToConsole(`Error de conexión: ${e.message}`,"ERROR"),placeholder.textContent="Error de conexión con el servidor.",placeholder.style.display="block"}finally{isProcessing=!1}})()):logToConsole("Por favor, selecciona un archivo primero.","ERROR")}),logToConsole("Dashboard cargado. Sistema listo.");</script></body></html>
